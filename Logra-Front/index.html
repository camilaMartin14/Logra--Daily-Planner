<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logra – Daily Planner</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="paper-texture"></div>

    

    <div class="container py-4 content-wrapper">
        <header class="text-center mb-4 fade-in">
            <h1 class="display-5 fw-bold planner-title">
                <i class="fa-solid fa-arrow-trend-up"></i>
                Logra 
            </h1>
            <p class="lead text-muted fst-italic planner-subtitle">Daily Planner</p>
            
            <div class="d-flex justify-content-center align-items-center gap-3 mt-4">
                <button class="btn btn-link nav-btn" id="prev-day-btn" title="Día anterior">
                    <i class="bi bi-chevron-left"></i>
                </button>
                <div id="current-date" class="date-badge"></div>
                <button class="btn btn-link nav-btn" id="next-day-btn" title="Día siguiente">
                    <i class="bi bi-chevron-right"></i>
                </button>
            </div>
            <div id="day-status-indicator" class="mt-2 text-muted small fst-italic" style="height: 20px;"></div>
        </header>

        <div class="row g-3">
            <div class="col-lg-7 col-md-12">
                <div class="d-flex flex-column gap-3">
                    
                    <div class="card h-100 planner-card shadow-sm main-todo-card">
                        <div class="card-body p-3">
                            <div class="d-flex flex-column flex-sm-row justify-content-between align-items-center mb-3 gap-2">
                                <h2 class="h4 card-title mb-0"><i class="bi bi-check2-square me-2"></i>Tareas</h2>
                                
                                <div class="d-flex gap-2 filter-container align-items-center">
                                    <select class="form-select form-select-sm" id="task-category-filter" style="max-width: 150px;">
                                        <option value="">Todas las cat.</option>
                                    </select>
                                    <div class="vr"></div>
                                    <button class="btn btn-sm filter-btn active" data-filter="all">
                                        Todas <span class="badge rounded-pill ms-1" id="count-all">0</span>
                                    </button>
                                    <button class="btn btn-sm filter-btn" data-filter="pending">
                                        Pendientes <span class="badge rounded-pill ms-1" id="count-pending">0</span>
                                    </button>
                                    <button class="btn btn-sm filter-btn" data-filter="completed">
                                        Listas <span class="badge rounded-pill ms-1" id="count-completed">0</span>
                                    </button>
                                </div>
                            </div>

                            <div class="input-group mb-3">
                                <select class="form-select" id="new-task-category" style="max-width: 150px;">
                                    <option value="">Sin categoría</option>
                                </select>
                                <input type="text" id="new-task-input" class="form-control form-control-lg planner-input" placeholder="Escribe una nueva tarea...">
                                <button class="btn btn-primary planner-btn" type="button" id="add-task-btn">
                                    <i class="bi bi-plus-lg"></i>
                                </button>
                            </div>

                            <ul class="list-group list-group-flush" id="todo-list">
                            </ul>
                            
                            <div id="empty-state" class="text-center py-5 text-muted" style="display: none;">
                                <i class="bi bi-flower1 fs-1 opacity-50"></i>
                                <p class="mt-2">Todo listo por ahora. ¡Disfruta tu día!</p>
                            </div>
                        </div>
                    </div>

                    <div class="card planner-card shadow-sm">
                        <div class="card-body p-3">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h2 class="h4 card-title mb-0"><i class="bi bi-journal-richtext me-2"></i>Notas</h2>
                                <button class="btn btn-sm btn-primary planner-btn" id="btn-new-note">
                                    <i class="bi bi-plus-lg"></i> Nueva
                                </button>
                            </div>
                            
                            <div class="row g-2 mb-3">
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text bg-white border-end-0"><i class="bi bi-search"></i></span>
                                        <input type="text" class="form-control border-start-0 ps-0" id="notes-search" placeholder="Buscar...">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <select class="form-select form-select-sm" id="notes-filter-category">
                                        <option value="">Categoría...</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <div class="d-flex w-100 gap-1">
                                        <button type="button" class="btn btn-sm filter-btn flex-fill active" id="filter-active-notes">Activas</button>
                                        <button type="button" class="btn btn-sm filter-btn flex-fill" id="filter-archived-notes">Archiv.</button>
                                    </div>
                                </div>
                            </div>

                            <div id="notes-list" class="row g-2" style="max-height: 500px; overflow-y: auto;">
                            </div>
                        </div>
                    </div>

                    <div class="card planner-card shadow-sm bg-daily-note">
                        <div class="card-body p-3">
                            <h3 class="h5 card-title mb-3"><i class="bi bi-journal-text me-2"></i>Nota del Día</h3>
                            <textarea id="daily-note" class="form-control planner-textarea" rows="4" placeholder="Un pensamiento, gratitud o recordatorio..."></textarea>
                            
                            <div class="d-flex justify-content-end mt-3 d-none auth-only">
                                <span id="msg-save-daily-note" class="me-2 text-success small fst-italic fade-out" style="opacity: 0;">¡Guardado!</span>
                                <button class="btn btn-sm btn-outline-primary planner-btn-outline" id="btn-save-daily-note">Guardar Nota</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="col-lg-5 col-md-12">
                <div class="d-flex flex-column gap-3">
                    <div class="right-top-row d-flex align-items-start gap-3">
                        <div class="card planner-card shadow-sm flex-grow-1">
                            <div class="card-body p-3">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h3 class="h5 card-title mb-0"><i class="bi bi-tags me-2"></i>Categorías</h3>
                                    <button class="btn btn-sm btn-outline-primary planner-btn-outline" id="btn-new-category">
                                        <i class="bi bi-plus-lg"></i>
                                    </button>
                                </div>
                                <div id="categories-list" class="list-group list-group-flush">
                                </div>
                            </div>
                        </div>
                        <div class="d-flex flex-column gap-2 align-items-center">
                            <div class="card planner-card shadow-sm calendar-card">
                                <div class="card-body p-3">
                                    <h3 class="h6 card-title mb-2"><i class="bi bi-calendar3 me-2"></i>Calendario</h3>
                                    <div id="calendar-wrapper" class="calendar-wrapper">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <button class="btn btn-sm btn-link nav-btn" id="cal-prev-month"><i class="bi bi-chevron-left"></i></button>
                                            <span class="fw-bold" id="cal-month-year"></span>
                                            <button class="btn btn-sm btn-link nav-btn" id="cal-next-month"><i class="bi bi-chevron-right"></i></button>
                                        </div>
                                        <div class="calendar-grid" id="calendar-grid"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="calendar-float">
                                <button class="btn btn-primary planner-btn w-100 calendar-float-btn " id="btn-month-pdf">
                                    Descarga tu resumen
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card planner-card shadow-sm">
                        <div class="card-body p-3">
                            <h3 class="h5 card-title mb-3"><i class="bi bi-emoji-smile me-2"></i>Mood del Día</h3>
                            <div class="d-flex justify-content-around mood-selector">
                                <button class="btn btn-outline-mood mood-btn" data-mood="happy" title="Feliz">
                                    <i class="bi bi-emoji-laughing"></i>
                                </button>
                                <button class="btn btn-outline-mood mood-btn" data-mood="neutral" title="Neutral">
                                    <i class="bi bi-emoji-neutral"></i>
                                </button>
                                <button class="btn btn-outline-mood mood-btn" data-mood="sad" title="Triste">
                                    <i class="bi bi-emoji-frown"></i>
                                </button>
                            </div>
                            <div class="text-center mt-2">
                                <small id="selected-mood-text" class="text-muted fst-italic"></small>
                            </div>
                        </div>
                    </div>

                    <div class="card planner-card shadow-sm">
                        <div class="card-body p-3">
                            <h3 class="h5 card-title mb-3"><i class="bi bi-heart-pulse me-2"></i>Bienestar</h3>
                            
                            <div class="mb-3">
                                <label class="d-block small text-muted text-uppercase fw-bold mb-2">Hidratación</label>
                                <div class="d-flex justify-content-between px-2" id="hydration-container">
                                </div>
                            </div>

                            <div>
                                <label class="d-block small text-muted text-uppercase fw-bold mb-2">Horas de Sueño</label>
                                <div class="d-flex justify-content-between px-2" id="sleep-container">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card planner-card shadow-sm">
                        <div class="card-body p-3">
                            <h3 class="h5 card-title mb-3"><i class="bi bi-egg-fried me-2"></i>Comidas</h3>
                            
                            <div class="meal-input-group">
                                <label for="meal-breakfast" class="meal-label">Desayuno</label>
                                <input type="text" id="meal-breakfast" class="form-control planner-input" placeholder="¿Qué desayunaste?">
                            </div>

                            <div class="meal-input-group">
                                <label for="meal-lunch" class="meal-label">Almuerzo</label>
                                <input type="text" id="meal-lunch" class="form-control planner-input" placeholder="¿Qué almorzaste?">
                            </div>

                            <div class="meal-input-group">
                                <label for="meal-dinner" class="meal-label">Cena</label>
                                <input type="text" id="meal-dinner" class="form-control planner-input" placeholder="¿Qué cenaste?">
                            </div>

                            <div class="meal-input-group">
                                <label for="meal-snack" class="meal-label">Snacks</label>
                                <input type="text" id="meal-snack" class="form-control planner-input" placeholder="Picoteos...">
                            </div>

                            <div class="d-flex justify-content-end mt-3">
                                <span id="msg-save-meals" class="me-2 text-success small fst-italic fade-out" style="opacity: 0;">¡Guardado!</span>
                                <button class="btn btn-sm btn-outline-primary planner-btn-outline" id="btn-save-meals">Guardar Comidas</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>


        <div class="row mt-5">
            <div class="col-12 text-center">
                
                <div class="auth-teaser p-4 rounded-3" id="auth-teaser-login">
                    <p class="mb-3 text-muted">Si quieres persistir tus tareas en la nube, inicia sesión.</p>
                    <div class="d-flex justify-content-center gap-3">
                        <button class="btn btn-outline-primary planner-btn-outline" data-bs-toggle="modal" data-bs-target="#loginModal">Iniciar Sesión</button>
                        <button class="btn btn-primary planner-btn" data-bs-toggle="modal" data-bs-target="#registerModal">Registrarse</button>
                    </div>
                </div>

                
                <div class="auth-teaser p-3 rounded-3 d-none" id="auth-teaser-logout">
                    <p class="mb-3 text-muted">Hola, <span id="user-name-display" class="fw-bold">Usuario</span>. Tienes la sesión iniciada.</p>
                    <div class="d-flex justify-content-center gap-3">
                        <button class="btn btn-outline-danger planner-btn-outline" id="btn-logout" style="border-color: #e57373; color: #e57373;">Cerrar Sesión</button>
                    </div>
                </div>
            </div>
        </div>

        <footer class="text-center mt-5 py-3 text-muted">
            <small>Logra 2025 – Desarrollado por <a href="https://www.linkedin.com/in/camilamartindev/" target="_blank" class="text-decoration-none text-muted">Camila Martín</a></small>
        </footer>
    </div>

    <div class="modal fade" id="taskModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content planner-modal">
                <div class="modal-header border-0">
                    <h5 class="modal-title font-serif">Editar Tarea</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="taskForm">
                        <input type="hidden" id="taskId">
                        <div class="mb-3">
                            <label for="taskDescription" class="form-label">Descripción</label>
                            <input type="text" class="form-control planner-input" id="taskDescription" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Categorías</label>
                            <div id="task-categories-selection" class="d-flex flex-wrap gap-2">
                            </div>
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                             <button type="button" class="btn btn-outline-secondary planner-btn-outline" data-bs-dismiss="modal">Cancelar</button>
                             <button type="submit" class="btn btn-primary planner-btn">Guardar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="noteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content planner-modal">
                <div class="modal-header border-0">
                    <h5 class="modal-title font-serif" id="noteModalTitle">Nueva Nota</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="noteForm">
                        <input type="hidden" id="noteId">
                        <div class="mb-3">
                            <label for="noteTitle" class="form-label">Título</label>
                            <input type="text" class="form-control planner-input" id="noteTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="noteContent" class="form-label">Contenido</label>
                            <textarea class="form-control planner-textarea" id="noteContent" rows="6"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Categorías</label>
                            <div id="note-categories-selection" class="d-flex flex-wrap gap-2">
                            </div>
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                             <button type="button" class="btn btn-outline-secondary planner-btn-outline" data-bs-dismiss="modal">Cancelar</button>
                             <button type="submit" class="btn btn-primary planner-btn">Guardar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- CATEGORY MODAL -->
    <div class="modal fade" id="categoryModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content planner-modal">
                <div class="modal-header border-0">
                    <h5 class="modal-title font-serif" id="categoryModalTitle">Nueva Categoría</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="categoryForm">
                        <input type="hidden" id="categoryId">
                        <div class="mb-3">
                            <label for="categoryName" class="form-label">Nombre</label>
                            <input type="text" class="form-control planner-input" id="categoryName" required>
                        </div>
                        <div class="mb-3">
                            <label for="categoryColor" class="form-label">Color</label>
                            <input type="color" class="form-control form-control-color w-100" id="categoryColor" value="#563d7c" title="Elige un color">
                        </div>
                        <div class="d-flex justify-content-end gap-2">
                             <button type="button" class="btn btn-outline-secondary planner-btn-outline" data-bs-dismiss="modal">Cancelar</button>
                             <button type="submit" class="btn btn-primary planner-btn">Guardar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content planner-modal">
                <div class="modal-header border-0">
                    <h5 class="modal-title font-serif">Iniciar Sesión</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control planner-input" id="loginEmail">
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Contraseña</label>
                            <div class="input-group">
                                <input type="password" class="form-control planner-input" id="loginPassword">
                                <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('loginPassword')">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary planner-btn">Ingresar</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="registerModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content planner-modal">
                <div class="modal-header border-0">
                    <h5 class="modal-title font-serif">Registrarse</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <div class="row">
                            <div class="col-6 mb-3">
                                <label for="regName" class="form-label">Nombre</label>
                                <input type="text" class="form-control planner-input" id="regName">
                            </div>
                            <div class="col-6 mb-3">
                                <label for="regSurname" class="form-label">Apellido</label>
                                <input type="text" class="form-control planner-input" id="regSurname">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="regEmail" class="form-label">Email</label>
                            <input type="email" class="form-control planner-input" id="regEmail">
                        </div>
                        <div class="mb-3">
                            <label for="regPassword" class="form-label">Contraseña</label>
                            <div class="input-group">
                                <input type="password" class="form-control planner-input" id="regPassword">
                                <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('regPassword')">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="regConfirmPassword" class="form-label">Confirmar Contraseña</label>
                            <div class="input-group">
                                <input type="password" class="form-control planner-input" id="regConfirmPassword">
                                <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('regConfirmPassword')">
                                    <i class="bi bi-eye"></i>
                                </button>
                            </div>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary planner-btn">Registrarse</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://kit.fontawesome.com/8d77e74cbe.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="js/api.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/dayApi.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script type="module" src="js/taskApi.js"></script>
    <script type="module" src="js/categoryApi.js"></script>
    <script type="module" src="js/noteApi.js"></script>
    <script type="module" src="js/planner.js"></script>
    <script type="module" src="js/categories.js"></script>
    <script type="module" src="js/notes.js"></script>
</body>
</html>
